&ACCESS RVP
&REL 393
&PARAM TEMPLATE = C:\KRC\Roboter\Template\vorgabe
&PARAM EDITMASK = *
DEF FORCETEST( )
INT X
DECL BOOL TEMP, SEMP, HEMP
DECL FRAME PT1, PT2
DECL CHAR DIRECTION
DECL INT SIGN
DECL CHAR FORCE[13]
DECL REAL FZ,STIFFNESS

;FOLD INI
  ;FOLD BASISTECH INI
    GLOBAL INTERRUPT DECL 3 WHEN $STOPMESS==TRUE DO IR_STOPM ( )
    INTERRUPT ON 3 
    BAS (#INITMOV,0 )
  ;ENDFOLD (BASISTECH INI)
  ;FOLD USER INI
    ;Make your modifications here
  ;ENDFOLD (USER INI)
;ENDFOLD (INI)

$ADVANCE=3

$STIFFNESS.STRATEGY=10
$STIFFNESS.COMMIT=TRUE
$ORI_TYPE=#CONSTANT
$TOOL=TOOL_DATA[5]
$VEL.CP=1.0
$VEL.ORI1=100
$VEL.ORI2=100
$ACC.CP=1.0
$ACC.ORI1=100
$ACC.ORI2=100
FOR X=1 TO 6
$ACC_AXIS[X]=100
$VEL_AXIS[X]=100
ENDFOR
PT2={X 0,Y 0,Z 0,A 0,B 0,C 0}

;CHANGE THIS EACH TIME
;SIGN=1 IS POSITIVE
;SIGN=-1 IS NEGATIVE
DIRECTION="Z"
SIGN=-1
STIFFNESS=10
;AMOUNT OF FORCE WANTED
FZ=20
$OV_PRO=40


;FOLD PTP P1 Vel=100 % PDAT1 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P1, 3:, 5:100, 7:PDAT1
$BWDSTART=FALSE
PDAT_ACT=PPDAT1
FDAT_ACT=FP1
BAS(#PTP_PARAMS,100)
PTP XP1 
;ENDFOLD


PT1= GETPOINT(DIRECTION,SIGN)
PTP PT1

TEMP=TRIG()

SEMP=SETSTIFF(DIRECTION,STIFFNESS)

HEMP=SETFORCE(DIRECTION,FZ)

IF DIRECTION=="X" THEN
  PT2.X=6*SIGN
ENDIF
IF DIRECTION=="Y" THEN
  PT2.Y=6*SIGN
ENDIF
IF DIRECTION=="Z" THEN
  PT2.Z=-6
ENDIF

LIN_REL PT2

WAIT SEC 5

$STIFFNESS.STRATEGY=10
$STIFFNESS.COMMIT=TRUE
$OV_PRO=40

LIN_REL {Z 30}

;FOLD PTP P2 Vel=100 % PDAT2 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P2, 3:, 5:100, 7:PDAT2
$BWDSTART=FALSE
PDAT_ACT=PPDAT2
FDAT_ACT=FP2
BAS(#PTP_PARAMS,100)
PTP XP2 
;ENDFOLD





END