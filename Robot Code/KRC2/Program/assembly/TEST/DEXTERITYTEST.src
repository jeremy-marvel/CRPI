&ACCESS RVP
&REL 286
&PARAM TEMPLATE = C:\KRC\Roboter\Template\vorgabe
&PARAM EDITMASK = *
DEF DEXTERITYTEST( )
DECL BOOL TEMP, HEMP, SEMP, REMP
INT X, n, result
DECL INT md_int[16]
DECL REAL md_real[16]
;FOLD INI
  ;FOLD BASISTECH INI
    GLOBAL INTERRUPT DECL 3 WHEN $STOPMESS==TRUE DO IR_STOPM ( )
    INTERRUPT ON 3 
    BAS (#INITMOV,0 )
  ;ENDFOLD (BASISTECH INI)
  ;FOLD USER INI
    ;Make your modifications here

  ;ENDFOLD (USER INI)
   LOGROBOTDATA=TRUE
   SERVERCONNECTED=TRUE
   TCPCONNECTION=FALSE
;ENDFOLD (INI)

$TOOL=TOOL_DATA[5]
$VEL.CP=1.0
$VEL.ORI1=100
$VEL.ORI2=100
$ACC.CP=1.0
$ACC.ORI1=80
$ACC.ORI2=80
FOR X=1 TO 6
$ACC_AXIS[X]=70
$VEL_AXIS[X]=70
ENDFOR

CANDLE()

$OV_PRO=8

;FOLD PTP P2 Vel=100 % PDAT2 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P2, 3:, 5:100, 7:PDAT2
$BWDSTART=FALSE
PDAT_ACT=PPDAT2
FDAT_ACT=FP2
BAS(#PTP_PARAMS,100)
PTP XP2 
;ENDFOLD

;FOLD PTP P1 Vel=100 % PDAT1 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P1, 3:, 5:100, 7:PDAT1
$BWDSTART=FALSE
PDAT_ACT=PPDAT1
FDAT_ACT=FP1
BAS(#PTP_PARAMS,100)
PTP XP1 
;ENDFOLD

;FORCE ON RED DOTS
;FOR X=1 TO 8
  ;TEMP=TRIG()
  ;TEMP=SETSTIFF("Z", 10.0)
  ;TEMP=SETFORCE("Z", 68.85)
  ;LIN_REL{Y 1}
  ;LIN_REL{Z 100}
  ;WAIT SEC 2
  ;LIN_REL{Y -1}
  ;TEMP=FORCEZSTOP()
  ;PTP $POS_ACT_MES
  ;$STIFFNESS.STRATEGY=10
  ;$STIFFNESS.COMMIT=TRUE
;ENDFOR

;FOR CONSTANT FORCE
TEMP=TRIG()
HEMP=SETSTIFF("Z", 10.0)
SEMP=SETFORCE("Z", 68.65)

LIN_REL{Y 1}
LIN_REL{Z 800}

REMP=FORCEZSTOP()

FOR n=1 TO 16
  md_int[n]=0
  md_real[n]=0
ENDFOR

md_real[1]=0.01

result=MD_CMD("PAPAS","TRIGBYCONTACT",md_int[],md_real[])

PTP $POS_ACT_MES

$STIFFNESS.STRATEGY=10
$STIFFNESS.COMMIT=TRUE

;FOLD PTP P3 Vel=100 % PDAT3 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P3, 3:, 5:100, 7:PDAT3
$BWDSTART=FALSE
PDAT_ACT=PPDAT3
FDAT_ACT=FP3
BAS(#PTP_PARAMS,100)
PTP XP3 
;ENDFOLD

CANDLE()

;FOLD PTP P4 Vel=100 % PDAT12 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P4, 3:, 5:100, 7:PDAT12
$BWDSTART=FALSE
PDAT_ACT=PPDAT12
FDAT_ACT=FP4
BAS(#PTP_PARAMS,100)
PTP XP4 
;ENDFOLD

;FOLD PTP P5 Vel=100 % PDAT11 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P5, 3:, 5:100, 7:PDAT11
$BWDSTART=FALSE
PDAT_ACT=PPDAT11
FDAT_ACT=FP5
BAS(#PTP_PARAMS,100)
PTP XP5 
;ENDFOLD

TEMP=TRIG()
HEMP=SETSTIFF("Y", 10.0)
SEMP=SETFORCE("Y", 68.65)

LIN_REL{Y -2}
LIN_REL{Z 800}

REMP=FORCEZSTOP()

PTP $POS_ACT_MES

$STIFFNESS.STRATEGY=10
$STIFFNESS.COMMIT=TRUE

$OV_PRO=25

;FOLD PTP P6 Vel=100 % PDAT13 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P6, 3:, 5:100, 7:PDAT13
$BWDSTART=FALSE
PDAT_ACT=PPDAT13
FDAT_ACT=FP6
BAS(#PTP_PARAMS,100)
PTP XP6 
;ENDFOLD

CANDLE()

LOGROBOTDATA=FALSE
SERVERCONNECTED=FALSE
TCPCONNECTION=FALSE

END