&ACCESS RVP
&REL 74
&PARAM TEMPLATE = C:\KRC\Roboter\Template\vorgabe
&PARAM EDITMASK = *
DEF MFORCETEST1( )

INT X
DECL BOOL TEMP, SEMP, HEMP, REMP
DECL E6AXIS TORQUE
REAL PERCENT, STEP

;FOLD INI
  ;FOLD BASISTECH INI
    GLOBAL INTERRUPT DECL 3 WHEN $STOPMESS==TRUE DO IR_STOPM ( )
    INTERRUPT ON 3 
    BAS (#INITMOV,0 )
  ;ENDFOLD (BASISTECH INI)
  ;FOLD USER INI
    ;Make your modifications here
  ;ENDFOLD (USER INI)
;ENDFOLD (INI)

$TOOL=TOOL_DATA[5]
FOR X=1 TO 6
$ACC_AXIS[X]=100
$VEL_AXIS[X]=100
ENDFOR

$OV_PRO=100

;FOLD PTP P6 Vel=100 % PDAT6 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P6, 3:, 5:100, 7:PDAT6
$BWDSTART=FALSE
PDAT_ACT=PPDAT6
FDAT_ACT=FP6
BAS(#PTP_PARAMS,100)
PTP XP6 
;ENDFOLD



TORQUE=$TORQUE_AXIS_ACT

REMP=FALSE
PERCENT=.5
STEP=-.1

WHILE NOT REMP 
  LIN_REL{Z -.1}
  TORQUE=$TORQUE_AXIS_ACT
  REMP=TORQUE.A1>(176*PERCENT)
  REMP= REMP OR (ABS(TORQUE.A2)>(176*PERCENT))
  REMP= REMP OR (ABS(TORQUE.A3)>(100*PERCENT))
  REMP= REMP OR (ABS(TORQUE.A4)>(100*PERCENT))
  REMP= REMP OR (ABS(TORQUE.A5)>(38*PERCENT))
  REMP= REMP OR (ABS(TORQUE.A6)>(38*PERCENT))
ENDWHILE

LIN_REL {Z 30}

;FOLD PTP P7 Vel=100 % PDAT7 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P7, 3:, 5:100, 7:PDAT7
$BWDSTART=FALSE
PDAT_ACT=PPDAT7
FDAT_ACT=FP7
BAS(#PTP_PARAMS,100)
PTP XP7 
;ENDFOLD


END