&ACCESS RVP
&REL 62
&PARAM TEMPLATE = C:\KRC\Roboter\Template\vorgabe
&PARAM EDITMASK = *
DEF GEARS( )
DECL FRAME PT1
DECL BOOL TEMP
DECL BOOL STATE
DECL IPO_MODE LAST_IPO
DECL E6POS POSITION
;FOLD INI
  ;FOLD BASISTECH INI
    GLOBAL INTERRUPT DECL 3 WHEN $STOPMESS==TRUE DO IR_STOPM ( )
    INTERRUPT ON 3 
    BAS (#INITMOV,0 )
  ;ENDFOLD (BASISTECH INI)
  ;FOLD USER INI
    ;Make your modifications here

  ;ENDFOLD (USER INI)
;ENDFOLD (INI)

$TOOL=TOOL_DATA[5]
$VEL.CP=.2
$VEL.ORI1=100
$VEL.ORI2=100
$ACC.CP=1.0
$ACC.ORI1=80
$ACC.ORI2=80
$ADVANCE=5

;FOLD PTP P1 Vel=100 % PDAT1 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P1, 3:, 5:100, 7:PDAT1
$BWDSTART=FALSE
PDAT_ACT=PPDAT1
FDAT_ACT=FP1
BAS(#PTP_PARAMS,100)
PTP XP1 
;ENDFOLD

;PTP{X 11.82,Y -590.80,Z 100,A 3.52,B 0,C -180}

;FOLD PTP P3 Vel=100 % PDAT3 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P3, 3:, 5:100, 7:PDAT3
$BWDSTART=FALSE
PDAT_ACT=PPDAT3
FDAT_ACT=FP3
BAS(#PTP_PARAMS,100)
PTP XP3 
;ENDFOLD

STATE = STARTIMPEDANCE(TRUE)
TEMP=SETFORCE("Z",5)

LIN_REL{Z -12}

;LAST_IPO = $IPO_MODE
;$IPO_MODE = #TCP

; Clear all search parameters
STATE = CANCEL_SEARCH()

; Alarm clock test:  Passed
STATE = STATE AND ADDTERMCLOCK(#ALARMCLOCK, #FAIL, 20000.0, 5)

STATE = STATE AND ADDTERMDISTANCE(#SUCCESS, 0.0, 0.0, 20.0,20.0)

;BOOL ADDSEARCHROTATION(REAL RANGE, REAL SPEED)
STATE = STATE AND ADDSEARCHROTATION(60.0, 10.0)

;POSITION=$POS_ACT_MES
WHILE STATE
   STATE = (SEARCH()==#RUNNING)

ENDWHILE

TEMP=FORCEZSTOP()
$STIFFNESS.STRATEGY=10
$STIFFNESS.COMMIT=TRUE

STATE=STARTIMPEDANCE(FALSE)

STATE = CANCEL_SEARCH()

LIN_REL{Z 50}
;FOLD PTP P2 Vel=100 % PDAT2 Tool[5]:Pneumatic_gripper_probe Base[0];%{PE}%R 5.6.11,%MKUKATPBASIS,%CMOVE,%VPTP,%P 1:PTP, 2:P2, 3:, 5:100, 7:PDAT2
$BWDSTART=FALSE
PDAT_ACT=PPDAT2
FDAT_ACT=FP2
BAS(#PTP_PARAMS,100)
PTP XP2 
;ENDFOLD


END